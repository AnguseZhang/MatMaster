#!/usr/bin/env python3
"""
Update summary_cn in agents-tool.json by translating summary_prompt
"""
import json
from pathlib import Path

project_root = Path(__file__).parent.parent

# Translations - I'll provide these directly
translations = {
    "unielf_inference": "根据输出结果总结 Uni-ELF 推理结果：\n1. 报告完整结果 CSV 文件的 URL (`result_csv`)。\n2. 列出 `top_10_results_dict` 中的前 10 个配方。对于每个配方，显示 `formulation_id`、组成（结合 `smiles_i` 和 `ratio_i`）以及预测的属性值（以 `_pred` 结尾的键）。\n3. 突出显示表现最好的配方。\n",
    
    "fetch_bohrium_crystals": "\n## 响应格式\n响应必须始终包括：\n1. ✅ 简要说明应用的筛选条件\n2. 📊 检索到的结构的 Markdown 表格\n   - 列（固定顺序）：\n     (1) 化学式 (`formula`)\n     (2) 元素（从 `formula` 推导）\n     (3) 原子数（如果 `crystal_ext.number_of_atoms` 可用；否则 **未提供**）\n     (4) 空间群（如果 `crystal_ext.symbol` 可用且可以映射到编号；否则 **未提供**）\n     (5) 能量/形成能（如果 `crystal_ext.predicted_formation_energy` 可用；否则 **未提供**）\n     (6) 带隙（如果 `crystal_ext.band_gap` 可用；否则 **未提供**）\n     (7) 下载链接（CIF/JSON，基于 `output_formats`）\n     (8) 来源数据库 → 始终为 `\"BohriumPublic\"`\n     (9) ID (`id`)\n   - 缺失值必须填写为 **未提供**\n   - 行数**必须完全等于** `n_found`\n3. 📦 工具返回的 `output_dir` 路径（用于下载/归档）\n\n如果 `n_found = 0`，请明确说明未找到匹配项，重复应用的筛选条件，并建议放宽条件。**不要**生成空表格。\n",
    
    "fetch_mofs_sql": "## 响应格式\n1. 简要说明使用的 SQL 查询\n2. 检索到的 MOF 的 Markdown 表格，包含相关列\n3. 用于下载/归档的输出目录路径\n4. 结果中的关键发现（如适用）\n",
    
    "fetch_openlam_structures": "\n## 响应格式\n响应必须始终包括：\n1. ✅ 简要说明应用的筛选条件\n2. 📊 检索到的结构的 Markdown 表格\n   - 列（固定顺序）：\n     (1) 化学式 (`formula`)\n     (2) 元素（从 `formula` 推导）\n     (3) 原子数 → **未提供**（OpenLAM 不提供此字段）\n     (4) 空间群 → **未提供**（OpenLAM 不提供此字段）\n     (5) 能量/形成能（如果 `energy` 可用；否则 **未提供**）\n     (6) 带隙 → **未提供**（OpenLAM 不提供此字段）\n     (7) 下载链接（CIF/JSON，基于 `output_formats`）\n     (8) 来源数据库 → 始终为 `\"OpenLAM\"`\n     (9) ID (`id`)\n   - 缺失值必须填写为 **未提供**\n   - 行数**必须完全等于** `n_found`\n3. 📦 工具返回的 `output_dir` 路径（用于下载/归档）\n\n如果 `n_found = 0`，请明确说明未找到匹配项，重复应用的筛选条件，并建议放宽条件。**不要**生成空表格。\n",
    
    "fetch_structures_with_filter": "\n## 响应格式\n响应必须始终按顺序包含三个部分：\n1. 应用的筛选条件和提供者的简要说明。\n2. 列出所有检索结果的 Markdown 表格。\n3. 归档文件的下载链接（.tgz）。\n表格必须在一个完整的 Markdown 表格中包含所有检索到的材料，不得遗漏、截断、总结或使用省略号。行数必须完全等于 `n_found`，即使结果很多（最多 30 个），它们都必须显示在同一表格中。归档链接是补充性的，永远不能替代完整表格。\n每个表格必须始终按此固定顺序包含以下九列：\n(1) 化学式 (`attributes.chemical_formula_reduced`)\n(2) 元素（元素列表；从化学式推断）\n(3) 原子数（如果提供者可用；否则 **未提供**）\n(4) 空间群 (`Symbol(Number)`；键可能因提供者而异（例如 `_alexandria_space_group`、`_oqmd_spacegroup`），因此您必须自己推理；如果只提供了一个，您必须使用您的知识自动提供另一个；如果两者都不可用，请准确填写 **未提供**）。\n(5) 能量/形成能（如果可用；否则 **未提供**）\n(6) 带隙（如果可用；否则 **未提供**）\n(7) 下载链接（CIF 或 JSON 文件）\n(8) 提供者（从提供者 URL 推断）\n(9) ID (`cleaned_structures[i][\"id\"]`)\n如果任何属性缺失，必须填写为 **未提供**（无斜杠、替代或翻译）。只有在明确请求时才能添加额外列（例如，晶格向量、带隙、形成能）；如果此类数据不可用， also 填写 **未提供**。\n如果未找到结果（`n_found = 0`），请明确说明未检索到匹配结构，重复应用的筛选条件，并建议放宽条件，但不要生成空表格。始终验证表格行数是否等于 `n_found`；如果不匹配，请重新生成表格直到正确。永远不要声称令牌或简洁性问题，因为结果已经限制在最多 100 个。\n",
    
    "fetch_structures_with_spg": "\n## 响应格式\n响应必须始终按顺序包含三个部分：\n1. 应用的筛选条件和提供者的简要说明。\n2. 列出所有检索结果的 Markdown 表格。\n3. 归档文件的下载链接（.tgz）。\n表格必须在一个完整的 Markdown 表格中包含所有检索到的材料，不得遗漏、截断、总结或使用省略号。行数必须完全等于 `n_found`，即使结果很多（最多 30 个），它们都必须显示在同一表格中。归档链接是补充性的，永远不能替代完整表格。\n每个表格必须始终按此固定顺序包含以下九列：\n(1) 化学式 (`attributes.chemical_formula_reduced`)\n(2) 元素（元素列表；从化学式推断）\n(3) 原子数（如果提供者可用；否则 **未提供**）\n(4) 空间群 (`Symbol(Number)`；键可能因提供者而异（例如 `_alexandria_space_group`、`_oqmd_spacegroup`），因此您必须自己推理；如果只提供了一个，您必须使用您的知识自动提供另一个；如果两者都不可用，请准确填写 **未提供**）。\n(5) 能量/形成能（如果可用；否则 **未提供**）\n(6) 带隙（如果可用；否则 **未提供**）\n(7) 下载链接（CIF 或 JSON 文件）\n(8) 提供者（从提供者 URL 推断）\n(9) ID (`cleaned_structures[i][\"id\"]`)\n如果任何属性缺失，必须填写为 **未提供**（无斜杠、替代或翻译）。只有在明确请求时才能添加额外列（例如，晶格向量、带隙、形成能）；如果此类数据不可用， also 填写 **未提供**。\n如果未找到结果（`n_found = 0`），请明确说明未检索到匹配结构，重复应用的筛选条件，并建议放宽条件，但不要生成空表格。始终验证表格行数是否等于 `n_found`；如果不匹配，请重新生成表格直到正确。永远不要声称令牌或简洁性问题，因为结果已经限制在最多 100 个。\n",
    
    "fetch_structures_with_bandgap": "\n## 响应格式\n响应必须始终按顺序包含三个部分：\n1. 应用的筛选条件和提供者的简要说明。\n2. 列出所有检索结果的 Markdown 表格。\n3. 归档文件的下载链接（.tgz）。\n表格必须在一个完整的 Markdown 表格中包含所有检索到的材料，不得遗漏、截断、总结或使用省略号。行数必须完全等于 `n_found`，即使结果很多（最多 30 个），它们都必须显示在同一表格中。归档链接是补充性的，永远不能替代完整表格。\n每个表格必须始终按此固定顺序包含以下九列：\n(1) 化学式 (`attributes.chemical_formula_reduced`)\n(2) 元素（元素列表；从化学式推断）\n(3) 原子数（如果提供者可用；否则 **未提供**）\n(4) 空间群 (`Symbol(Number)`；键可能因提供者而异（例如 `_alexandria_space_group`、`_oqmd_spacegroup`），因此您必须自己推理；如果只提供了一个，您必须使用您的知识自动提供另一个；如果两者都不可用，请准确填写 **未提供**）。\n(5) 能量/形成能（如果可用；否则 **未提供**）\n(6) 带隙（如果可用；否则 **未提供**）\n(7) 下载链接（CIF 或 JSON 文件）\n(8) 提供者（从提供者 URL 推断）\n(9) ID (`cleaned_structures[i][\"id\"]`)\n如果任何属性缺失，必须填写为 **未提供**（无斜杠、替代或翻译）。只有在明确请求时才能添加额外列（例如，晶格向量、带隙、形成能）；如果此类数据不可用， also 填写 **未提供**。\n如果未找到结果（`n_found = 0`），请明确说明未检索到匹配结构，重复应用的筛选条件，并建议放宽条件，但不要生成空表格。始终验证表格行数是否等于 `n_found`；如果不匹配，请重新生成表格直到正确。永远不要声称令牌或简洁性问题，因为结果已经限制在最多 100 个。\n",
    
    "predict_tensile_strength": "## 响应格式\n\n**返回：**\n- 浮点值列表：预测的抗拉强度值列表（单位：MPa）\n- 顺序与输入化学式列表匹配\n- 示例：三个化学式为 [650.25, 680.50, 695.30]\n",
    
    "query_heakb_literature": "## 工具输出\n\n工具返回：\n- **summaries**：文献摘要列表（List[str]）\n  - 每个摘要是包含一篇文献论文摘要的文本字符串\n  - 这些摘要是**原始材料** - 您必须将它们综合成一份全面的报告\n- **code**：状态码\n  - 0：成功（有摘要可用）\n  - 1：未找到结果\n  - 2：无法读取文献全文\n  - 4：其他错误\n\n## 响应格式\n\n**关键**：工具返回的是原始摘要。您**必须**将它们综合成一份全面、深入的研究报告。\n**不要**简单地列出或连接摘要 - 将它们综合成统一、连贯的叙述。\n\n## 表达风格：\n- 语调：学术、理性，但具有启发性\n- 表达：清晰、分层，不引入无关内容\n- 避免空洞的摘要：每个声明必须明确由摘要中的事实、数值数据或方法细节支持\n- 包含分析深度：在相关时提供研究之间的比较、矛盾或确认\n- 如果用户的问题是开放式的，提供全面分析，包括：\n    1. 机制洞察（反应路径、驱动力、结构-性能关系）\n    2. 定量或半定量结果（材料名称、数值数据、性能指标、空间群等）\n    3. 当前研究中的不一致、局限性或空白\n- 除非必要，不要过度强调技术细节（仪器设置或计算软件和参数设置）\n\n## 格式说明：\n- 使用清晰的章节标题（##、###）输出纯文本，除非必要否则不使用项目符号\n- 避免没有摘要证据的声明（例如，“第一个”、“最好的”、“最受欢迎的”）\n- 在数字和单位之间添加空格（例如，10 cm，5 kg）\n- 对物理量使用斜体（例如，*E*、*T*、*k*）\n- 对向量使用粗体（例如，**F**、**E**）和化合物/材料的序列代码名称（例如，化合物 **1**）\n- 在首次使用时定义缩写，并在整个文本中一致使用\n- 使用 [1]、[2]、[3] 格式在整个文本中引用来源（数字指摘要顺序）\n\n## 报告结构：\n1. **引言**：关键概念的专业定义、近年来的主要突破、仍未解决的主要挑战、分析的论文数量\n\n2. **主要内容**：组织成具有子章节的逻辑章节（##、###）。对于每个章节：\n   - 整合来自多个摘要的发现，并提供详细解释\n   - 包括具体的定量数据、实验条件和结果\n   - 深入解释机制和过程（事物**如何**工作，而不仅仅是**什么**发生）\n   - 比较不同研究的发现，突出一致性和分歧\n   - 在适用时使用表格比较不同研究的数据\n   - 解决当前理解中的矛盾或空白\n\n3. **结论**：总结关键发现、当前研究的局限性、未来研究方向\n",
    
    "query_polymerkb_literature": "## 工具输出\n\n工具返回：\n- **summaries**：文献摘要和数据库条目列表（List[str]）\n  - 每个项目可以是：\n    - 详细的文献摘要（对于有全文的论文）：包含论文的全面分析\n    - 数据库条目（对于没有全文的论文）：包含 DOI 和数据库属性（例如，polymer_type、tensile_strength、flexural_strength 等）\n  - 这些摘要和条目是**原始材料** - 您必须将它们综合成一份全面的报告\n- **code**：状态码\n  - 0：成功（有摘要可用）\n  - 1：未找到结果\n  - 2：无法读取文献全文\n  - 4：其他错误\n\n## 响应格式\n\n**关键**：工具返回的是原始摘要和数据库条目。您**必须**将它们综合成一份全面、深入的研究报告。\n**不要**简单地列出或连接摘要 - 将它们综合成统一、连贯的叙述。\n\n**重要**：摘要列表可能包含两种类型的条目：\n1. **详细的文献摘要**：包含论文的全面分析，包括方法、结果、讨论等\n2. **数据库条目**：包含 DOI 和数据库属性（例如，polymer_type、tensile_strength、flexural_strength 等）\n\n您应该将这两种类型的条目整合到报告中，使用文献摘要提供深入分析，使用数据库条目提供定量数据。\n\n## 表达风格：\n- 语调：学术、理性，但具有启发性\n- 表达：清晰、分层，不引入无关内容\n- 避免空洞的摘要：每个声明必须明确由摘要中的事实、数值数据或方法细节支持\n- 包含分析深度：在相关时提供研究之间的比较、矛盾或确认\n\n## 格式说明：\n- 使用清晰的章节标题（##、###）输出纯文本，除非必要否则不使用项目符号\n- 避免没有摘要证据的声明\n- 在数字和单位之间添加空格\n- 对物理量使用斜体，对向量和材料名称使用粗体\n- 在首次使用时定义缩写\n- 使用 [1]、[2]、[3] 格式引用来源\n\n## 报告结构：\n1. **引言**：关键概念的专业定义、近年来的主要突破、仍未解决的主要挑战\n2. **主要内容**：整合来自多个摘要和数据库条目的发现\n3. **结论**：总结关键发现、当前研究的局限性、未来研究方向\n",
    
    "query_steelkb_literature": "## 工具输出\n\n工具返回：\n- **summaries**：文献摘要列表（List[str]）\n  - 每个摘要是包含一篇文献论文摘要的文本字符串\n  - 这些摘要是**原始材料** - 您必须将它们综合成一份全面的报告\n- **code**：状态码\n  - 0：成功（有摘要可用）\n  - 1：未找到结果\n  - 2：无法读取文献全文\n  - 4：其他错误\n\n## 响应格式\n\n**关键**：工具返回的是原始摘要。您**必须**将它们综合成一份全面、深入的研究报告。\n**不要**简单地列出或连接摘要 - 将它们综合成统一、连贯的叙述。\n\n## 表达风格：\n- 语调：学术、理性，但具有启发性\n- 表达：清晰、分层，不引入无关内容\n- 避免空洞的摘要：每个声明必须明确由摘要中的事实、数值数据或方法细节支持\n- 包含分析深度：在相关时提供研究之间的比较、矛盾或确认\n\n## 格式说明：\n- 使用清晰的章节标题（##、###）输出纯文本，除非必要否则不使用项目符号\n- 避免没有摘要证据的声明\n- 在数字和单位之间添加空格\n- 对物理量使用斜体，对向量和材料名称使用粗体\n- 在首次使用时定义缩写\n- 使用 [1]、[2]、[3] 格式引用来源\n\n## 报告结构：\n1. **引言**：关键概念的专业定义、近年来的主要突破、仍未解决的主要挑战\n2. **主要内容**：整合来自多个摘要的发现\n3. **结论**：总结关键发现、当前研究的局限性、未来研究方向\n",
    
    "query_ssekb_literature": "## 工具输出\n\n工具返回：\n- **summaries**：文献摘要和数据库条目列表（List[str]）\n  - 每个项目可以是：\n    - 详细的文献摘要（对于有全文的论文）：包含论文的全面分析\n    - 数据库条目（对于没有全文的论文）：包含 DOI 和数据库属性（例如，材料属性、实验数据等）\n  - 这些摘要和条目是**原始材料** - 您必须将它们综合成一份全面的报告\n- **code**：状态码\n  - 0：成功（有摘要可用）\n  - 1：未找到结果\n  - 2：无法读取文献全文\n  - 4：其他错误\n\n## 响应格式\n\n**关键**：工具返回的是原始摘要和数据库条目。您**必须**将它们综合成一份全面、深入的研究报告。\n**不要**简单地列出或连接摘要 - 将它们综合成统一、连贯的叙述。\n\n**重要**：摘要列表可能包含两种类型的条目：\n1. **详细的文献摘要**：包含论文的全面分析，包括方法、结果、讨论等\n2. **数据库条目**：包含 DOI 和数据库属性（例如，材料属性、实验数据等）\n\n您应该将这两种类型的条目整合到报告中，使用文献摘要提供深入分析，使用数据库条目提供定量数据。\n\n## 表达风格：\n- 语调：学术、理性，但具有启发性\n- 表达：清晰、分层，不引入无关内容\n- 避免空洞的摘要：每个声明必须明确由摘要中的事实、数值数据或方法细节支持\n- 包含分析深度：在相关时提供研究之间的比较、矛盾或确认\n\n## 格式说明：\n- 使用清晰的章节标题（##、###）输出纯文本，除非必要否则不使用项目符号\n- 避免没有摘要证据的声明\n- 在数字和单位之间添加空格\n- 对物理量使用斜体，对向量和材料名称使用粗体\n- 在首次使用时定义缩写\n- 使用 [1]、[2]、[3] 格式引用来源\n\n## 报告结构：\n1. **引言**：关键概念的专业定义、近年来的主要突破、仍未解决的主要挑战\n2. **主要内容**：整合来自多个摘要和数据库条目的发现\n3. **结论**：总结关键发现、当前研究的局限性、未来研究方向\n",
    
    "search-papers-enhanced": "您是一位学术情报专家，其职责是整合、筛选、分析和评估科学信息，以支持精确的研究导向决策。\n\n# 语言要求\n输入查询应始终使用**英语**以确保专业性。\n响应应使用 {{target_language}}。\n\n# 知识使用限制：\n- 所有事实信息（数据、结论、定义、实验结果等）必须来自工具调用结果；\n- 您可以使用自己的知识来组织、解释和推理这些事实，但不能凭空添加信息。\n- 引用时，尽量直接使用原始表达。\n\n# 必须遵循这些先验知识：\n（包含材料命名规则等先验知识）\n\n# 格式说明：\n- 输出纯文本，除非必要或用户要求，否则不使用项目符号。\n- 避免以任何前言、致谢、确认或元陈述开头，例如“当然，我将...”、“好的，我将...”或“我现在将分析...”。相反，直接输出实质性内容。\n- 避免没有论文证据的声明，例如第一个、最好的、最受欢迎的等。\n\n# 输出长度和覆盖要求：\n- 您必须始终生成详尽、扩展和完全阐述的输出。\n\n# 内部大纲协议（大纲不得显示）：\n- 在开始时，内部构建一个详细的分层大纲，至少包含 3 个主要章节和多个子章节。除非明确要求，否则不得向用户显示此大纲。\n- 大纲应大致从简要解释所涉及的关键术语、基于摘要声明的主要研究空白开始。\n- 您必须使用此内部大纲来指导一个长、全面和完全结构化的最终输出。\n",
    
    "web-search": "您是一位学术情报专家，其职责是整合、筛选、分析和评估科学信息，以支持精确的研究导向决策。\n\n# 语言要求\n输入查询应始终使用**英语**以确保专业性。\n响应应使用 {{target_language}}。\n\n# 必须遵循这些先验知识：\n（包含材料命名规则等先验知识）\n\n# 格式说明：\n- 输出纯文本，除非必要或用户要求，否则不使用项目符号。\n- 避免以任何前言、致谢、确认或元陈述开头。\n- 避免没有证据的声明。\n\n# 输出长度和覆盖要求：\n- 您必须始终生成详尽、扩展和完全阐述的输出。\n",
    
    "extract_info_from_webpage": "您是一位学术情报专家，其职责是整合、筛选、分析和评估科学信息，以支持精确的研究导向决策。\n\n# 语言要求\n输入查询应始终使用**英语**以确保专业性。\n响应应使用 {{target_language}}。\n\n# 必须遵循这些先验知识：\n（包含材料命名规则等先验知识）\n\n# 格式说明：\n- 输出纯文本，除非必要或用户要求，否则不使用项目符号。\n- 避免以任何前言、致谢、确认或元陈述开头。\n- 避免没有证据的声明。\n\n# 输出长度和覆盖要求：\n- 您必须始终生成详尽、扩展和完全阐述的输出。\n",
}

def main():
    json_file = project_root / "agents-tool.json"
    
    # Read JSON
    print(f"Reading {json_file}...")
    with open(json_file, "r", encoding="utf-8") as f:
        data = json.load(f)
    
    # Update summary_cn for each tool
    updated_count = 0
    for tool in data["tools"]:
        name = tool.get("name", "")
        if name in translations:
            tool["summary_cn"] = translations[name]
            updated_count += 1
            print(f"  ✓ Updated {name}")
    
    # Save updated JSON
    print(f"\nSaving updated JSON...")
    with open(json_file, "w", encoding="utf-8") as f:
        json.dump(data, f, indent=2, ensure_ascii=False)
    
    print(f"✓ Successfully updated {updated_count} summaries")
    print(f"✓ Updated {json_file}")

if __name__ == "__main__":
    main()

